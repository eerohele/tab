(ns tab.template
  (:require [tab.html :refer [$] :as html]))

(def ^:private favicon
  "data:image/png;base64,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")

(defn page
  [{:keys [server-id]} main]
  ($ :html {:lang "en"}
    ($ :head
      ($ :title "Tab")
      ($ :meta {:charset "utf-8"})
      ($ :link {:rel "icon" :href favicon})
      ($ :link {:rel "stylesheet" :href (format "/assets/css/tab.%s.css" server-id)}))
    ($ :body
      ($ :script "0")
      ($ :main main)
      ($ :div {:class "event-source-error"}
        ($ :p ($ :a {:href "/"} "disconnected from server, click to reload")))
      ($ :div {:class "ok"} "âœ“")
      ($ :script {:src (format "/assets/js/tab.%s.js" server-id) :defer "true"}))))

(comment
  (html/html (page {:server-id "foo"} "hello"))
  ,,,)
